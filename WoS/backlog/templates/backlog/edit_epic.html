{% extends 'backlog/base.html' %}

{% block title %}Edit Epic â€” {{ epic.title }}{% endblock %}

{% block content %}
<div class="page-hint">
  <strong>ğŸ“š Edit Epic:</strong> Update this epic's title and description. Stories linked to this epic will remain unchanged.
</div>

<form method="post" action="" class="page-content-with-fixed-bar" id="epic-form">
  {% csrf_token %}
  
  <!-- Big clickable title -->
  <h1 id="title-display" class="title-display" onclick="showTitleInput()">
    {{ epic.title }}
  </h1>
  <input type="text" id="title-input" class="title-input" name="title" value="{{ epic.title }}" placeholder="Epic title..." onblur="hideTitleInput()" required>

  <!-- Epic Details -->
  <div class="content-section">
    <h3>ğŸ“ Epic Details</h3>
    <p class="section-hint">Provide context about what this epic aims to achieve.</p>
    <div class="text-fields">
      <div class="form-group">
        <label for="epic_description" class="field-title">Description</label>
        <textarea id="epic_description" name="description" rows="5" placeholder="Describe the epic's goals and scope...">{{ epic.description }}</textarea>
        <p class="field-hint">ğŸ’¡ A good description helps the team understand the purpose and scope.</p>
      </div>
    </div>
  </div>
</form>

<!-- Fixed save bar at bottom of screen -->
<div class="fixed-save-bar">
  <button type="submit" form="epic-form">ğŸ’¾ Save Epic</button>
  <a href="{% url 'backlog:index' %}" class="back-link">â† Back to Epics</a>
</div>

<script>
function showTitleInput() {
  document.getElementById('title-display').classList.add('hidden');
  var input = document.getElementById('title-input');
  input.classList.add('active');
  input.focus();
  input.select();
}

function hideTitleInput() {
  var input = document.getElementById('title-input');
  var display = document.getElementById('title-display');
  var value = input.value.trim();
  display.textContent = value || 'Click to add title...';
  input.classList.remove('active');
  display.classList.remove('hidden');
}

// Add form validation
document.addEventListener('DOMContentLoaded', function() {
  var form = document.getElementById('epic-form');
  var titleInput = document.getElementById('title-input');
  
  form.addEventListener('submit', function(e) {
    var title = titleInput.value.trim();
    if (!title) {
      e.preventDefault();
      alert('âš ï¸ Please enter a title for the epic');
      document.getElementById('title-display').classList.add('hidden');
      titleInput.classList.add('active');
      titleInput.focus();
      return false;
    }
  });
});
</script>
{% endblock %}
