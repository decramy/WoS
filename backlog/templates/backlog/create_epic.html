{% extends 'backlog/base.html' %}

{% block title %}Create Epic ‚Äî WoS{% endblock %}

{% block content %}
<div class="page-hint">
  <strong>üìö Create a new Epic:</strong> Epics are large bodies of work that can be broken down into stories. 
  Give your epic a clear, descriptive title and optionally add a description to capture the goal.
</div>

<form method="post" action="" class="page-content-with-fixed-bar" id="epic-form">
  {% csrf_token %}
  
  <!-- Big clickable title -->
  <h1 id="title-display" class="title-display" onclick="showTitleInput()">
    ‚úèÔ∏è Click to add title...
  </h1>
  <input type="text" id="title-input" class="title-input" name="title" value="" placeholder="Epic title..." onblur="hideTitleInput()" required>

  <!-- Epic Details -->
  <div class="content-section">
    <h3>üìù Epic Details</h3>
    <p class="section-hint">Provide context about what this epic aims to achieve.</p>
    <div class="text-fields">
      <div class="form-group">
        <label for="epic_description" class="field-title">Description</label>
        <textarea id="epic_description" name="description" rows="5" placeholder="Describe the epic's goals and scope..."></textarea>
        <p class="field-hint">üí° A good description helps the team understand the purpose and scope.</p>
      </div>
    </div>
  </div>
</form>

<!-- Fixed save bar at bottom of screen -->
<div class="fixed-save-bar">
  <button type="submit" form="epic-form">‚ú® Create Epic</button>
  <a href="{% url 'backlog:epics' %}" class="back-link">‚Üê Back to Epics</a>
</div>

<script>
// Auto-focus title input for new epic
document.addEventListener('DOMContentLoaded', function() {
  var titleInput = document.getElementById('title-input');
  var titleDisplay = document.getElementById('title-display');
  
  // Automatically show and focus the title input
  titleDisplay.classList.add('hidden');
  titleInput.classList.add('active');
  titleInput.focus();
  
  // Add form validation
  var form = document.getElementById('epic-form');
  form.addEventListener('submit', function(e) {
    var title = titleInput.value.trim();
    if (!title) {
      e.preventDefault();
      alert('‚ö†Ô∏è Please enter a title for the epic');
      titleDisplay.classList.add('hidden');
      titleInput.classList.add('active');
      titleInput.focus();
      return false;
    }
  });
});

function showTitleInput() {
  document.getElementById('title-display').classList.add('hidden');
  var input = document.getElementById('title-input');
  input.classList.add('active');
  input.focus();
  input.select();
}

function hideTitleInput() {
  var input = document.getElementById('title-input');
  var display = document.getElementById('title-display');
  var value = input.value.trim();
  display.textContent = value || '‚úèÔ∏è Click to add title...';
  input.classList.remove('active');
  display.classList.remove('hidden');
}
</script>
{% endblock %}
